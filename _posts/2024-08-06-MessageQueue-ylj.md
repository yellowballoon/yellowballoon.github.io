---
title: "Message Queue"
date: 2024-08-06 00:00:00 -0000
categories: wiki
author: ylj
tags: wiki message Queue
---

# 메시지 큐 (Message Queue)

![Alt text](https://velog.velcdn.com/images/choidongkuen/post/b208dfbc-edd7-40ee-90b4-7fbd9f0f7166/image.png)

메시지 큐(Message Queue)는 메시지 기반의 애플리케이션 통합 패턴 중 하나로, 시스템 간의 데이터 교환을 비동기적으로 처리하는 방법을 제공합니다.

이를 통해 다양한 시스템이나 애플리케이션 간의 의사소통을 효율적으로 관리할 수 있습니다.

## 메시지 큐의 주요 개념

1. 프로듀서 (Producer): 메시지를 생성하여 큐에 넣는 역할을 합니다. 이는 데이터나 작업을 생성하는 시스템이나 애플리케이션입니다.
<br/>
2. 컨슈머 (Consumer): 큐에서 메시지를 읽고 처리하는 역할을 합니다. 이는 데이터를 받아서 처리하는 시스템이나 애플리케이션입니다.
<br/>
3. 큐 (Queue): 메시지가 저장되는 중간 저장소입니다. 큐는 메시지를 순서대로 저장하며, 일반적으로 FIFO(First In, First Out) 방식으로 메시지를 전달합니다.
<br/>
4. 메시지 (Message): 프로듀서가 생성하여 큐에 넣는 데이터입니다. 메시지는 보통 페이로드와 메타데이터로 구성됩니다.
<br/>http://npms.ybtour.co.kr/issues/117768
5. 브로커 (Broker): 메시지 큐 시스템을 관리하고 메시지의 라우팅을 담당하는 중개자입니다. 대표적인 메시지 브로커로는 RabbitMQ, Apache Kafka, AWS SQS 등이 있습니다.

## 메시지 큐의 주요 기능

1. 비동기 통신: 메시지 큐는 프로듀서와 컨슈머 간의 비동기 통신을 지원하여, 프로듀서가 메시지를 보내고 즉시 다음 작업을 수행할 수 있게 합니다. 컨슈머는 자신이 준비되었을 때 메시지를 처리할 수 있습니다.
<br/>
2. 내구성: 메시지 큐는 메시지를 안정적으로 저장하여 시스템 장애나 네트워크 문제 발생 시에도 메시지를 손실하지 않도록 합니다. 내구성은 메시지의 안전한 전달을 보장합니다.
<br/>
3. 로드 밸런싱: 메시지 큐는 여러 컨슈머 간에 메시지를 분배하여 시스템의 부하를 균등하게 분산시킵니다. 이를 통해 시스템의 성능과 안정성을 향상시킵니다.
<br/>
4. 스케일링: 메시지 큐 시스템은 수평 확장이 가능하여, 많은 양의 메시지를 효율적으로 처리할 수 있습니다. 필요에 따라 프로듀서나 컨슈머의 수를 늘려 처리 용량을 확장할 수 있습니다.

## 메시지 큐의 장점

1. 탈동기화: 메시지 큐를 사용하면 시스템 간의 의존성을 줄이고 독립적으로 작업을 처리할 수 있습니다. 이를 통해 시스템의 유연성과 응답성을 향상시킬 수 있습니다.
<br/>
2. 신뢰성: 메시지 큐는 메시지의 손실을 방지하고 안정적인 전달을 보장합니다. 장애 발생 시에도 메시지를 복구하고 다시 처리할 수 있습니다.
<br/>
3. 확장성: 메시지 큐는 시스템의 부하를 균등하게 분산시키고 수평 확장을 통해 대규모 트래픽을 처리할 수 있습니다.
<br/>
4. 복잡성 관리: 메시지 큐를 사용하면 시스템 간의 복잡한 상호작용을 간단하게 관리할 수 있습니다. 이를 통해 시스템의 유지보수와 확장이 용이해집니다.
<br/>
5. 낮은 결합도 : 애플리케이션과 분리할 수 있다.

## 메시지 큐의 단점

1. 복잡성 증가 : 메시지 큐를 도입하면 시스템의 아키텍처가 복잡해질 수 있습니다. 메시지 큐의 설정, 운영 및 모니터링을 위한 추가적인 도구와 지식이 필요합니다.
<br/>
2. 지연 시간 : 메시지 큐는 본질적으로 비동기적이기 때문에 메시지가 큐를 통해 전달되는 동안 지연이 발생할 수 있습니다. 실시간 처리가 필요한 경우 이 지연이 문제가 될 수 있습니다.
<br/>
3. 메시지 손실 : 잘못된 설정이나 네트워크 장애, 브로커의 문제로 인해 메시지가 손실될 수 있습니다. 이를 방지하기 위해 내구성 설정과 적절한 에러 핸들링이 필요합니다.
<br/>
4. 복잡한 에러 처리 : 메시지가 제대로 처리되지 않았을 때의 재시도 로직, 메시지 순서 보장, 중복 메시지 처리 등 에러 처리 로직이 복잡해질 수 있습니다.
<br/>
5. 성능 오버헤드 : 메시지 큐 시스템 자체가 추가적인 리소스를 소비합니다. 높은 처리량을 요구하는 시스템에서는 메시지 큐의 성능이 병목이 될 수 있습니다.
<br/>
6. 종속성 관리 : 메시지 큐 브로커가 시스템의 중요한 구성 요소가 되므로, 브로커의 가용성 및 성능 문제가 전체 시스템에 영향을 미칠 수 있습니다. 이를 위해 브로커의 클러스터링 및 모니터링이 필요합니다.
<br/>
7. 운영 비용 : 메시지 큐 브로커를 운영하기 위한 인프라와 관리 비용이 발생합니다. 특히 클라우드 기반의 메시지 큐 서비스를 사용하는 경우 사용량에 따라 비용이 증가할 수 있습니다.
<br/>
8. 트랜잭션 처리의 복잡성 : 메시지 큐를 사용하는 시스템에서 트랜잭션 일관성을 유지하는 것이 복잡할 수 있습니다. 특히 메시지 큐와 데이터베이스 간의 트랜잭션을 일관되게 유지하기 위해 추가적인 설계와 구현이 필요합니다.

## 메시지 큐의 사용 예시

1. 이메일 전송 시스템: 사용자 가입 시 확인 이메일을 보내는 시스템에서, 가입 요청을 받은 후 이메일 전송 작업을 비동기적으로 처리하여 사용자 경험을 개선할 수 있습니다.
<br/>
2. 로그 수집 및 처리: 다양한 서비스에서 발생하는 로그 데이터를 메시지 큐에 보내고, 로그 처리 시스템이 이를 실시간으로 수집하여 분석할 수 있습니다.
<br/>
3. 주문 처리 시스템: 전자상거래 사이트에서 주문을 받은 후, 주문 데이터를 메시지 큐에 넣고, 결제, 재고 확인, 배송 준비 등 다양한 작업을 비동기적으로 처리할 수 있습니다.
<br/>
4. 채팅 애플리케이션: 실시간 채팅 애플리케이션에서 메시지를 메시지 큐를 통해 전달하여, 메시지의 신뢰성과 확장성을 보장할 수 있습니다.

## 대표적인 메시지 큐 시스템

1. RabbitMQ: 오픈 소스 메시지 브로커로, AMQP (Advanced Message Queuing Protocol)를 지원합니다. 사용이 간편하고 다양한 기능을 제공하여 많은 프로젝트에서 사용됩니다.
<br/>
2. Apache Kafka: 대용량 데이터 스트리밍을 처리하기 위해 설계된 분산 메시징 시스템입니다. 높은 처리량과 내구성을 제공하여 로그 수집, 분석, 실시간 데이터 처리 등에 널리 사용됩니다.
<br/>
3. Amazon SQS (Simple Queue Service): AWS에서 제공하는 완전 관리형 메시지 큐 서비스로, 설정과 관리가 간편하며 높은 가용성과 내구성을 제공합니다.
<br/>
4. Azure Service Bus: Microsoft Azure에서 제공하는 메시징 서비스로, 다양한 메시징 패턴을 지원하며 높은 가용성과 확장성을 제공합니다.